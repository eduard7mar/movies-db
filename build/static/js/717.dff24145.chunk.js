"use strict";(self.webpackChunkmovies_db=self.webpackChunkmovies_db||[]).push([[717],{9717:(e,n,t)=>{t.r(n),t.d(n,{default:()=>q});var o=t(5043),i=t(8903),s=t(9252),r=t(5865),l=t(611);var a=t(950),d=t(3336),c=t(3193),u=t(258),x=t(7858),v=t(7121),h=t(1292),m=t(9413),p=t(4605),g=t(3217),A=t(1906),j=t(7733),f=t(4858),y=t(2628),b=t(579);function k(e){let{onApply:n}=e;const{control:t,handleSubmit:i,formState:s}=(0,f.mN)({defaultValues:{keywords:[],genres:[]}}),[r,l]=(0,o.useState)(""),{data:k=[],isLoading:w}=(0,y.q6)(r,{skip:!r}),{data:C,isLoading:I}=(0,y.eE)(),S=(0,o.useMemo)((()=>(0,a.A)((e=>{l(e)}),1e3)),[]);return(0,b.jsx)(d.A,{sx:{m:2,p:.5,maxWidth:350},children:(0,b.jsxs)("form",{onSubmit:i(n),children:[(0,b.jsx)(c.A,{sx:{m:2,display:"block"},component:"fieldset",variant:"standard",children:(0,b.jsx)(f.xI,{name:"keywords",control:t,render:e=>{let{field:{onChange:n,value:t}}=e;return(0,b.jsx)(u.A,{multiple:!0,loading:w,disablePortal:!0,options:k,filterOptions:e=>e,getOptionLabel:e=>e.name,onChange:(e,t)=>n(t),value:t,isOptionEqualToValue:(e,n)=>e.id===n.id,onInputChange:(e,n)=>S(n),renderInput:e=>(0,b.jsx)(x.A,{...e,label:"Keywords"})})}})}),(0,b.jsx)(c.A,{sx:{m:2,display:"block"},component:"fieldset",variant:"standard",children:I?(0,b.jsx)(v.A,{width:300,height:480}):(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(h.A,{component:"legend",children:"Genres"}),(0,b.jsx)(m.A,{sx:{maxHeight:500},children:(0,b.jsx)(f.xI,{name:"genres",control:t,render:e=>{let{field:n}=e;return(0,b.jsx)(b.Fragment,{children:null===C||void 0===C?void 0:C.map((e=>(0,b.jsx)(p.A,{control:(0,b.jsx)(g.A,{value:e.id,checked:n.value.includes(e.id),onChange:(e,t)=>{const o=Number(e.target.value);t?n.onChange([...n.value,o]):n.onChange(n.value.filter((e=>e!==o)))}}),label:e.name},e.id)))})}})})]})}),(0,b.jsx)(A.A,{type:"submit",sx:{m:2},variant:"contained",startIcon:(0,b.jsx)(j.A,{}),children:"Apply filter"})]})})}var w=t(2110),C=t(6591),I=t(6494),S=t(7600),F=t(7739),M=t(7392),N=t(6520),_=t(5475);function E(e){let{id:n,title:t,overview:o,popularity:i,onAddToFavorite:s,image:l="/movie-thumb.png",enableUserActions:a=!1}=e;return console.count("MovieCard"),(0,b.jsxs)(w.A,{sx:{height:"100%",display:"flex",flexDirection:"column"},children:[(0,b.jsx)(C.A,{component:"div",sx:{pt:"56.25%"},image:l}),(0,b.jsxs)(I.A,{sx:{flexGrow:1},children:[(0,b.jsx)(r.A,{gutterBottom:!0,variant:"h5",component:"h2",children:t}),(0,b.jsx)(r.A,{variant:"body2",color:"text.secondary",children:o}),(0,b.jsx)(r.A,{variant:"button",display:"block",mt:2,children:i})]}),(0,b.jsxs)(S.A,{children:[(0,b.jsx)(A.A,{component:_.N_,to:"/movies/".concat(n),color:"secondary",children:"Details"}),a&&(0,b.jsx)(F.A,{title:"Add to favorites",children:(0,b.jsx)(M.A,{onClick:()=>null===s||void 0===s?void 0:s(n),children:(0,b.jsx)(N.A,{})})})]})]})}const L=(0,o.memo)(E);var O=t(5447);const W={page:1,filters:{}};const q=function(){const{isAuthenticated:e,user:n}=(0,O.WB)(),[t,a]=(0,o.useState)(W),{data:d}=(0,y.EA)(),{data:c,isFetching:u}=(0,y.Lg)(t),x=null===c||void 0===c?void 0:c.results,v=null===c||void 0===c?void 0:c.hasMorePages,h=(0,o.useCallback)((()=>{v&&a((e=>({...e,page:e.page+1})))}),[v]),[m]=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{threshold:n=1,root:t=null,rootMargin:i="0px",onIntersect:s}=e,r=(0,o.useRef)(null),[l,a]=(0,o.useState)();return(0,o.useEffect)((()=>{const e=new IntersectionObserver((e=>{const[n]=e;n.isIntersecting&&(null===s||void 0===s||s()),a(n)}),{threshold:n,root:t,rootMargin:i}),o=r.current;return o&&e.observe(o),function(){o&&e.disconnect()}}),[s,t,i,n]),[r,l]}({onIntersect:h}),p=(0,o.useCallback)((e=>alert("Not implemented! Action: ".concat(null===n||void 0===n?void 0:n.name," is adding movie ").concat(e," to favorites."))),[null===n||void 0===n?void 0:n.name]);return(0,b.jsxs)(i.Ay,{container:!0,spacing:2,sx:{flexWrap:"nowrap"},children:[(0,b.jsx)(i.Ay,{item:!0,xs:"auto",children:(0,b.jsx)(k,{onApply:e=>{const n={keywords:null===e||void 0===e?void 0:e.keywords.map((e=>e.id)),genres:null===e||void 0===e?void 0:e.genres};a({page:1,filters:n})}})}),(0,b.jsx)(i.Ay,{item:!0,xs:12,children:(0,b.jsxs)(s.A,{sx:{py:8},maxWidth:"lg",children:[!u&&!(null!==x&&void 0!==x&&x.length)&&(0,b.jsx)(r.A,{variant:"h6",children:"No movies were found that match your query."}),(0,b.jsx)(i.Ay,{container:!0,spacing:4,children:null===x||void 0===x?void 0:x.map(((n,t)=>{return(0,b.jsx)(i.Ay,{item:!0,xs:12,sm:6,md:4,children:(0,b.jsx)(L,{id:n.id,title:n.title,overview:n.overview,popularity:n.popularity,image:(o=n.backdrop_path,o&&d?"".concat(d.images.base_url,"w780").concat(o):void 0),enableUserActions:e,onAddToFavorite:p},n.id)},n.id);var o}))}),(0,b.jsx)("div",{ref:m,children:u&&(0,b.jsx)(l.A,{color:"secondary",sx:{mt:3}})})]})})]})}}}]);
//# sourceMappingURL=717.dff24145.chunk.js.map